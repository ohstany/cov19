{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireWildcard = require(\"@babel/runtime-corejs2/helpers/interopRequireWildcard\");\n\nvar _interopRequireDefault = require(\"@babel/runtime-corejs2/helpers/interopRequireDefault\");\n\nvar _Object$defineProperty2 = require(\"@babel/runtime-corejs2/core-js/object/define-property\");\n\n_Object$defineProperty2(exports, \"__esModule\", {\n  value: true\n});\n\nexports.default = exports.RootProvider = void 0;\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime-corejs2/core-js/object/define-property\"));\n\nvar _defineProperties = _interopRequireDefault(require(\"@babel/runtime-corejs2/core-js/object/define-properties\"));\n\nvar _getOwnPropertyDescriptors = _interopRequireDefault(require(\"@babel/runtime-corejs2/core-js/object/get-own-property-descriptors\"));\n\nvar _getOwnPropertyDescriptor = _interopRequireDefault(require(\"@babel/runtime-corejs2/core-js/object/get-own-property-descriptor\"));\n\nvar _getOwnPropertySymbols = _interopRequireDefault(require(\"@babel/runtime-corejs2/core-js/object/get-own-property-symbols\"));\n\nvar _keys = _interopRequireDefault(require(\"@babel/runtime-corejs2/core-js/object/keys\"));\n\nvar _promise = _interopRequireDefault(require(\"@babel/runtime-corejs2/core-js/promise\"));\n\nvar _assign = _interopRequireDefault(require(\"@babel/runtime-corejs2/core-js/object/assign\"));\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime-corejs2/regenerator\"));\n\nvar _defineProperty3 = _interopRequireDefault(require(\"@babel/runtime-corejs2/helpers/defineProperty\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _api = _interopRequireDefault(require(\"../api\"));\n\nvar _router = require(\"next/router\");\n\nvar _reducers = require(\"./reducers\");\n\nvar _actions = require(\"./actions\");\n\nvar __jsx = _react.default.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = (0, _keys.default)(object); if (_getOwnPropertySymbols.default) { var symbols = (0, _getOwnPropertySymbols.default)(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return (0, _getOwnPropertyDescriptor.default)(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty3.default)(target, key, source[key]); }); } else if (_getOwnPropertyDescriptors.default) { (0, _defineProperties.default)(target, (0, _getOwnPropertyDescriptors.default)(source)); } else { ownKeys(Object(source)).forEach(function (key) { (0, _defineProperty2.default)(target, key, (0, _getOwnPropertyDescriptor.default)(source, key)); }); } } return target; }\n\nvar w = {\n  device: \"pc\"\n};\n\nif (true) {\n  w.device = window.innerWidth > 768 ? \"pc\" : \"mobile\";\n  document.body.classList.add(w.device);\n} // common global context\n\n\nvar RootContext = (0, _react.createContext)({});\n\nvar finalizeStore = function finalizeStore(_ref, single, _ref2, signal) {\n  var store, actions, reducer, loginStatus, logout, _ref3, reduce, actionExist;\n\n  return _regenerator.default.async(function finalizeStore$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          store = _ref.store, actions = _ref.actions, reducer = _ref.reducer;\n          loginStatus = _ref2.loginStatus, logout = _ref2.logout;\n          _ref3 = single || {}, reduce = _ref3.reduce;\n\n          if (reduce) {\n            _context.next = 5;\n            break;\n          }\n\n          return _context.abrupt(\"return\", false);\n\n        case 5:\n          actionExist = _objectSpread({}, actions[reduce] || {}, {}, single);\n\n          if (!(!actionExist.action || actionExist.api === false)) {\n            _context.next = 8;\n            break;\n          }\n\n          return _context.abrupt(\"return\", reducer(store, {\n            reduce: reduce,\n            data: actionExist.data || false\n          }));\n\n        case 8:\n          _context.t0 = reducer;\n          _context.t1 = store;\n          _context.t2 = reduce;\n          _context.next = 13;\n          return _regenerator.default.awrap((0, _api.default)(actionExist, signal, {\n            logout: logout,\n            loginStatus: loginStatus\n          }));\n\n        case 13:\n          _context.t3 = _context.sent;\n          _context.t4 = {\n            reduce: _context.t2,\n            data: _context.t3\n          };\n          _context.t5 = actionExist;\n          return _context.abrupt(\"return\", (0, _context.t0)(_context.t1, _context.t4, _context.t5));\n\n        case 17:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  });\n};\n\nvar setStoreReducer = function setStoreReducer(state, data) {\n  return _objectSpread({}, state, {}, data);\n}; // Context as global app store\n\n\nvar RootProvider = (0, _router.withRouter)(function (props) {\n  var loginStatus = props.loginStatus,\n      logout = props.logout,\n      children = props.children;\n\n  var _useReducer = (0, _react.useReducer)(setStoreReducer, _reducers.root_store_initial_state),\n      store = _useReducer[0],\n      setStore = _useReducer[1];\n\n  var actioner = function actioner(apiParams) {\n    var updater;\n    return _regenerator.default.async(function actioner$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            updater = {\n              api: apiParams,\n              toState: {},\n              signals: []\n            };\n            /** ARRAY:   if type is array we are able to make several\n             *           api request, reduce them, and then assign all data at once to the state\n             *  OBJECT:  single api request, reduce and state setter\n             */\n\n            if (!(updater.api instanceof Array)) {\n              _context3.next = 12;\n              break;\n            }\n\n            _context3.t0 = _assign.default;\n            _context3.t1 = {};\n            _context3.next = 6;\n            return _regenerator.default.awrap(_promise.default.all(updater.api.map(function _callee(single, x) {\n              return _regenerator.default.async(function _callee$(_context2) {\n                while (1) {\n                  switch (_context2.prev = _context2.next) {\n                    case 0:\n                      updater.signals[x] = new window.AbortController();\n                      _context2.next = 3;\n                      return _regenerator.default.awrap(finalizeStore({\n                        store: store,\n                        actions: _actions.rootActions,\n                        reducer: _reducers.root_store_reducer\n                      }, single, {\n                        loginStatus: loginStatus,\n                        logout: logout\n                      }, updater.signals[x]));\n\n                    case 3:\n                      return _context2.abrupt(\"return\", _context2.sent);\n\n                    case 4:\n                    case \"end\":\n                      return _context2.stop();\n                  }\n                }\n              });\n            })));\n\n          case 6:\n            _context3.t2 = function (p, n) {\n              return (0, _assign.default)({}, p, n);\n            };\n\n            _context3.t3 = {};\n            _context3.t4 = _context3.sent.reduce(_context3.t2, _context3.t3);\n            updater.toState = (0, _context3.t0)(_context3.t1, _context3.t4);\n            _context3.next = 16;\n            break;\n\n          case 12:\n            updater.signals[0] = new window.AbortController();\n            _context3.next = 15;\n            return _regenerator.default.awrap(finalizeStore({\n              store: store,\n              actions: _actions.rootActions,\n              reducer: _reducers.root_store_reducer\n            }, apiParams, {\n              loginStatus: loginStatus,\n              logout: logout\n            }, updater.signals[0]));\n\n          case 15:\n            updater.toState = _context3.sent;\n\n          case 16:\n            if (!updater.toState) {\n              _context3.next = 23;\n              break;\n            }\n\n            if (!(apiParams.set !== false)) {\n              _context3.next = 22;\n              break;\n            }\n\n            setStore(updater.toState);\n            return _context3.abrupt(\"return\", updater.toState);\n\n          case 22:\n            return _context3.abrupt(\"return\", {\n              data: updater.toState,\n              set: setStore\n            });\n\n          case 23:\n            return _context3.abrupt(\"return\", function clean() {\n              updater.signals.map(function (s) {\n                s.abort();\n              });\n            });\n\n          case 24:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    });\n  };\n\n  var _useState = (0, _react.useState)(\"pc\"),\n      device = _useState[0],\n      _device = _useState[1];\n\n  var getScreenState = function getScreenState(e) {\n    e.preventDefault();\n\n    _device(function (s) {\n      var canSet = s === \"mobile\" && window.innerWidth > 768 ? \"pc\" : s === \"pc\" && window.innerWidth <= 768 ? \"mobile\" : false;\n\n      if (canSet) {\n        document.body.classList.remove(canSet === \"mobile\" ? \"pc\" : \"mobile\");\n        document.body.classList.add(canSet);\n      }\n\n      return canSet || s;\n    });\n  };\n\n  (0, _react.useEffect)(function () {\n    if (true) {\n      var dev = window.innerWidth > 768 ? \"pc\" : \"mobile\";\n\n      _device(dev);\n\n      document.body.classList.add(dev);\n      window.addEventListener(\"resize\", getScreenState);\n    }\n  }, []);\n\n  var api = function api(data) {\n    var signal = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    return (0, _api.default)(data, signal, {\n      logout: logout,\n      loginStatus: state.loginStatus\n    });\n  };\n\n  return __jsx(RootContext.Provider, {\n    value: {\n      store: store,\n      actioner: actioner,\n      device: device,\n      setStore: setStore,\n      api: api\n    }\n  }, children);\n});\nexports.RootProvider = RootProvider;\nvar _default = RootContext;\nexports.default = _default;","map":null,"metadata":{},"sourceType":"script"}