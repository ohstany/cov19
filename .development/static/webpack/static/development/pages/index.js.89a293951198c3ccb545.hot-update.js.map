{"version":3,"file":"static/webpack/static/development/pages/index.js.89a293951198c3ccb545.hot-update.js","sources":["webpack:///./src/Templates/ActivityArea/index.js"],"sourcesContent":["import { useEffect, useState, useCallback } from \"react\";\nimport xmlToJson from \"Library/xmlToJson\";\nimport Pin from \"./pin.svg\";\nimport { Skeleton1 } from \"Templates/Skeleton\";\n\nconst protocol =\n\ttypeof window === \"undefined\" ? \"https:\" : window.location.protocol;\nconst proxyUrl = \"//cors-anywhere.herokuapp.com/\";\n\nconst News = ({ data }) => {\n\treturn (\n\t\t<div className=\"author\">\n\t\t\t{data.img && (\n\t\t\t\t<div className=\"imgb\">\n\t\t\t\t\t<img src={data.img} />\n\t\t\t\t</div>\n\t\t\t)}\n\n\t\t\t<h3 className={\"atitle clickable\"}>\n\t\t\t\t<a href={data.link} target=\"_blank\">\n\t\t\t\t\t{data.title}\n\t\t\t\t</a>\n\t\t\t</h3>\n\n\t\t\t<div className=\"desc\">{data.description}</div>\n\n\t\t\t<div className=\"source\">Ресурс: #</div>\n\t\t</div>\n\t);\n};\n\nexport default ({ context }) => {\n\tconst {\n\t\tstore: { index, markers, news = false, activity },\n\t\tsetStore\n\t} = context || {};\n\n\tconst active = index >= 0 ? markers[index] : false;\n\n\tconst comments = activity[index] || false;\n\n\tconst [nav, _nav] = useState(\"acts\");\n\n\tconst navigation = useCallback(key => {\n\t\t_nav(key);\n\t}, []);\n\n\tconst getNews = () => {\n      console.log(\"newsstrted\");\n      return;\n\t\tfetch(protocol + proxyUrl + \"https://gazeta.ua/rss\")\n\t\t\t.then(blop => {\n\t\t\t\treturn blop.text();\n\t\t\t})\n\t\t\t.then(res => {\n\t\t\t\tconst news = xmlToJson\n\t\t\t\t\t.parseString(res)\n\t\t\t\t\t.rss[0].channel[0].item.map(i => {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\ttitle: i.title[0]._text,\n\t\t\t\t\t\t\tlink: i.guid[0]._text,\n\t\t\t\t\t\t\tpubDate: i.pubDate[0]._text,\n\t\t\t\t\t\t\tdescription:\n\t\t\t\t\t\t\t\ti.description[0]._text\n\t\t\t\t\t\t\t\t\t.replace(/(<([^>]+)>)/gi, \"\")\n\t\t\t\t\t\t\t\t\t.substring(0, 180) + \"...\",\n\t\t\t\t\t\t\timg: i.enclosure && i.enclosure[0]._attr.url._value\n\t\t\t\t\t\t};\n\t\t\t\t\t});\n\n\t\t\t\tconsole.log(\"news\", news);\n\t\t\t\tsetStore({ news });\n\t\t\t});\n\t};\n\n\tuseEffect(() => {\n\t\tgetNews();\n\t}, []);\n\n\tuseEffect(() => {\n\t\tif (index >= 0) {\n\t\t\tnavigation(\"local\");\n\t\t}\n\t}, [index]);\n\n\tconst SingleItem = useCallback(({ nav, a, ax, news = false }) => {\n\t\treturn a ? (\n\t\t\t<div className=\"author\">\n\t\t\t\t<h3\n\t\t\t\t\tclassName={\"atitle\" + (nav === \"acts\" ? \" clickable\" : \"\")}\n\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\tif (nav === \"acts\") {\n\t\t\t\t\t\t\tsetStore({ index: ax });\n\t\t\t\t\t\t\tnavigation(\"local\");\n\t\t\t\t\t\t}\n\t\t\t\t\t}}>\n\t\t\t\t\t{news ? a.title : `Пользователь #${a.id}`}\n\t\t\t\t</h3>\n\n\t\t\t\t<div className=\"desc\">{a.content}</div>\n\n\t\t\t\t{a.source && a.source.length && (\n\t\t\t\t\t<div className=\"source\">\n\t\t\t\t\t\t{a.source.map((s, sx) => (\n\t\t\t\t\t\t\t<RenderSource key={sx} s={s} />\n\t\t\t\t\t\t))}\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\n\t\t\t\t{nav === \"acts\" && (\n\t\t\t\t\t<button\n\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\tsetStore({ index: ax });\n\t\t\t\t\t\t\tnavigation(\"local\");\n\t\t\t\t\t\t}}>\n\t\t\t\t\t\tОткрыть\n\t\t\t\t\t</button>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t) : (\n\t\t\t\"Нажмите не метку на карте\"\n\t\t);\n\t}, []);\n\n\tconst RenderSource = useCallback(({ s }) => {\n\t\treturn (\n\t\t\t<div className=\"src\">\n\t\t\t\t{s.indexOf(\"youtube\") >= 0 && s.indexOf(\"iframe\") >= 0 ? (\n\t\t\t\t\t<div\n\t\t\t\t\t\tdangerouslySetInnerHTML={{\n\t\t\t\t\t\t\t__html: s\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t) : (\n\t\t\t\t\t<a href={s} target=\"_blank\">\n\t\t\t\t\t\t{s}\n\t\t\t\t\t</a>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t);\n\t}, []);\n\n\treturn (\n\t\t<div className={\"block activityArea \" + nav}>\n\t\t\t<nav>\n\t\t\t\t<ol>\n\t\t\t\t\t{[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: \"local\",\n\t\t\t\t\t\t\ttitle: <Pin />\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{ id: \"acts\", title: \"Активность\" },\n\t\t\t\t\t\t{ id: \"news\", title: \"Новости\" }\n\t\t\t\t\t].map((m, mx) => {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<li\n\t\t\t\t\t\t\t\tkey={mx}\n\t\t\t\t\t\t\t\tclassName={\n\t\t\t\t\t\t\t\t\t\"navi \" + (m.id === nav ? \"active\" : \"\")\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\tnavigation(m.id);\n\t\t\t\t\t\t\t\t}}>\n\t\t\t\t\t\t\t\t{m.title}\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t);\n\t\t\t\t\t})}\n\t\t\t\t</ol>\n\t\t\t</nav>\n\n\t\t\t<div className={\"activity\"}>\n\t\t\t\t<div className=\"bb b1\">\n\t\t\t\t\t{markers.length ? (\n\t\t\t\t\t\tmarkers.map((a, ax) => {\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<SingleItem nav={nav} key={ax} a={a} ax={ax} />\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t})\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<Skeleton1 row={5} />\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\n\t\t\t\t<div className=\"bb b2\">\n\t\t\t\t\t<SingleItem nav={nav} a={active} ax={0} />\n\t\t\t\t\t{active && (\n\t\t\t\t\t\t<div className=\"comments\">\n\t\t\t\t\t\t\t<h3>Коментарии ({comments.length || 0})</h3>\n\t\t\t\t\t\t\t{comments\n\t\t\t\t\t\t\t\t? comments.map((c, cx) => {\n\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"cm author\" key={cx}>\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"chead\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<b>{c.user}</b>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{c.date ? (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\" - \" + c.date}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"cbody\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t{c.content}\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t  })\n\t\t\t\t\t\t\t\t: \"Пока нет коментариев, напишите первым\"}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\n\t\t\t\t<div className=\"bb b3\">\n\t\t\t\t\t{news.length ? (\n\t\t\t\t\t\tnews.map((a, ax) => {\n\t\t\t\t\t\t\treturn <News key={ax} data={a} ax={ax} />;\n\t\t\t\t\t\t})\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<Skeleton1 row={5} />\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AAAA;AACA;AACA;AACA;;;;AAFA;;;;;;;;;;;;;;;;;;;;;AAAA;;;;AAGA;AAEA;AACA;AACA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAKA;AAEA;AACA;AATA;AAAA;AAAA;AACA;AAWA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AAGA;AACA;AACA;AACA;AACA;AAIA;AARA;AAUA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AAPA;AAAA;AAAA;AAAA;AAAA;AAAA;AAWA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAQA;AACA;AAAA;AAAA;AACA;AACA;AAJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAYA;AAEA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AADA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAFA;AAIA;AAAA;AAAA;AACA;AAAA;AAAA;AAEA;AAEA;AACA;AAGA;AACA;AACA;AAPA;AAAA;AAAA;AAAA;AAAA;AAAA;AAWA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AAMA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;AACA;;;;;A","sourceRoot":""}